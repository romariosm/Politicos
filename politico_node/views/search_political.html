<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">

		<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.css">

		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
		


		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.devbridge-autocomplete/1.3.0/jquery.autocomplete.js"></script>

		<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>

		
	<style>
		.autocomplete-suggestions { border: 1px solid #999; background: #FFF; overflow: auto; }
		.autocomplete-suggestion { padding: 2px 5px; white-space: nowrap; overflow: hidden; }
		.autocomplete-selected { background: #F0F0F0; }
		.autocomplete-suggestions strong { font-weight: normal; color: #3399FF; }
		.autocomplete-group { padding: 2px 5px; }
		.autocomplete-group strong { display: block; border-bottom: 1px solid #000; }

		.avatar {
					/* cambia estos dos valores para definir el tamaño de tu círculo */  
		    width:120px;
		    height:120px;
		    border-radius:100%;
		    border:3px solid white;
		    
		    
		}

		.avatar2 {
					/* cambia estos dos valores para definir el tamaño de tu círculo */  
		    width: 60px;
		    height:60px;
		    border-radius:100%;
		    border:3px solid white;
		    
		    
		}
		

		.political-thumbnail{
			background: rgba(255,255,255,0); 
			border-radius:0px; 
			
		    border: 20px solid rgba(0, 0, 0, 0);
		    margin: 8px;
		    flex-direction: column;

		    -webkit-box-shadow: 0 8px 6px -6px #999 !important;
            -moz-box-shadow: 0 8px 6px -6px #999 !important;
			box-shadow: 0 4px 8px 0px #999 !important;


		}

		.btn-thumbnail{

			display: block;
			border-radius: 100%;
			background-color: #222;
			height: 40px;
			width: 40px;
			border: rgba(0, 0, 0, 1);
			font-size: 20px;
			text-align:  center;
			cursor: pointer;
		    color: #fff;
		    outline: 0;
		    -webkit-transition: all .3s;
		    -moz-transition: all .3s;
		    transition: all .3s; 

			}
		.btn-thumbnail:hover { 
    		background-color: #148f76;
    		color: white;
    	}
    	.political-thumbnail:hover{

    		background-color: rgba(62,75,88, 0.7); 

    		background-color: rgba(19,44,56, 0.4); 		

    		background-color: rgba(19,44,56, 0.7); 

			
    	}
    	.margin-top-panel{
    		margin-top: 20px
    	}

    	.no-border{
    		border-radius: 0px;
    	}
    	.panel-header{
    		margin-top: 0px;
    		margin-bottom: 0px;
    		margin-right: 0px;
    		margin-left: 0px;
    	}
    	.nav-shadow{
		    -webkit-box-shadow: 0 8px 6px -6px #999 !important;
            -moz-box-shadow: 0 8px 6px -6px #999 !important;
			box-shadow: 0 4px 8px 0px #999 !important;
			background-image: url('/images/sayata.png');
		}
		
		.grid-item{
			width: 360px
		}

		.btn-site{
			background-color: #1ab394;
			border-color: #1ab394;
			color: #FFFFFF;

		}

		.btn-site:hover{
			background-color: #148f76;
			border-color: #148f76;
			color: #FFFFFF;
		}

		.btn-site-info{
			
			background-color: #969292;
			border-color: #969292;
			color: #FFFFFF;		 
		}

		.btn-site-info:hover{
			
			background-color: #a7b1c2;
			border-color: #a7b1c2;
			color: #FFFFFF;		 
		}



		.footer-bottom {
		    background-color: #e7eaec;
		    min-height: 30px;
		    width: 100%;
		}
		.copyright {
		    color: #676a6c;
		    line-height: 30px;
		    min-height: 30px;
		    padding: 7px 0;
		}
		.design {
		    color: #676a6c;
		    line-height: 30px;
		    min-height: 30px;
		    padding: 7px 0;
		    text-align: right;
		}
		.design a {
		    color: #676a6c;
		}

		.pagination a {
		    color: black;
		    float: left;
		    padding: 8px 16px;
		    text-decoration: none;

		}
	    

	    .pagination a.active {
		    background-color: #1ab394;
		    color: white;
		}

		.pagination a:hover:not(.active) {background-color: rgba(62,75,88, 0.7);}

		.rv{
			    height: 150px;
    			background-size: cover;
    			background-image: url('http://visitas.presidencia.gov.co/web/fts/casa-narino-1-fachada.jpg') ;

    			
    			padding-top: 0.25rem;
    			  
 
			}

		.rp{
			-webkit-box-flex: 40;
			flex: 1 1 auto;
    		padding: 0.25rem;
			    
		}
		

	</style>

	</head>

	<script>

	var political_list=[]

	$(document).ready(function() {
		$('#autocomplete').autocomplete({
		    serviceUrl: '/autocomplete/politicos',

		    onSelect: function (suggestion) {
		        //alert('You selected: ' + suggestion.value + ', ' + suggestion.data);
		    },
		    onSearchComplete: function (query, suggestions) {


		    },
		    minChars:3

		});

		
		var grid=$('.grid').masonry({
		  // options
		  itemSelector: '.grid-item',
		  
		});

		$.get( "/search/getsuggestion", { search: "<%= search %>" } )
			.done(function( data ) {
				console.log(JSON.parse(data))

				data_list=JSON.parse(data)

				getDataSuggestion(data_list.suggestions,0)
				//data_list.suggestions.forEach(function(element){

				//});
					
			})

		})

	function getDataSuggestion(list, cont){

		if(cont<list.length){


		$.ajax( {
				url:"/search/getDataSuggestion?search="+list[cont],
				type: 'GET',
				success:function(response){

					data_politic={}
					data_politic=JSON.parse(response)

					if(JSON.parse(response)!= null && JSON.parse(response) != undefined){

					if(JSON.parse(response).Politic){

						political_list.push(JSON.parse(response))
						console.log(JSON.parse(response))

						$("#table_body").empty();

						for(i=0;i<political_list.length; i=i+3){
							if (political_list[i].Imagen== "no disponible"){

								imagen='/images/hombre.png'
							}else{
								imagen=political_list[i].Imagen
							}

							if((i) == political_list.length-1){


								$("#table_body").append('<tr>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen+'" height = "50px" width="50px"> <a style="cursor:pointer" onclick="search_political('+"'"+political_list[i].Url+"'"+')">'+political_list[i].Title+'<a/></td>'+
													'</tr>')
							}else if((i+1) == political_list.length-1){

								if (political_list[i+1].Imagen== "no disponible"){

									imagen1='/images/hombre.png'
								}else{
									imagen1=political_list[i+1].Imagen
								}

								$("#table_body").append('<tr>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen+'" height = "50px" width="50px">  <a style="cursor:pointer" onclick="search_political('+"'"+political_list[i].Url+"'"+')" >'+political_list[i].Title+'<a/></td>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen1+'" height = "50px" width="50px"> <a style="cursor:pointer"onclick="search_political('+"'"+political_list[i+1].Url+"'"+')">'+political_list[i+1].Title+'<a/></td>'+
													'</tr>')
							}else{
								if (political_list[i+1].Imagen== "no disponible"){

									imagen1='/images/hombre.png'
								}else{
									imagen1=political_list[i+1].Imagen
								}

								if (political_list[i+2].Imagen== "no disponible"){

									imagen2='/images/hombre.png'
								}else{
									imagen2=political_list[i+2].Imagen
								}
								$("#table_body").append('<tr>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen+'" height = "50px" width="50px">  <a style="cursor:pointer" onclick="search_political('+"'"+political_list[i].Url+"'"+')" >'+political_list[i].Title+'<a/></td>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen1+'" height = "50px" width="50px">  <a style="cursor:pointer" onclick="search_political('+"'"+political_list[i+1].Url+"'"+')" >'+political_list[i+1].Title+'<a/></td>'+
													'<td><img class="avatar2" style="object-fit: cover" src="'+imagen2+'" height = "50px" width="50px">  <a style="cursor:pointer" onclick="search_political('+"'"+political_list[i+2].Url+"'"+') ">'+political_list[i+2].Title+'<a/></td>'+
													'</tr>')
							}
										
						}



					}

				}

					getDataSuggestion(list, cont+1)

				},
			});

		}else{

			$("#load_label").removeClass('fa-circle-o-notch')
			$("#load_label").removeClass('fa-spin')
			$("#load_label").addClass('fa-check-circle-o')
			

		}

		
	}

	function search_political(url){

		$("#loading_div").modal('toggle')

		$.get( "/search/getScrapy", { 'url': url } )
			.done(function( data ) {
				$("#loading_div").modal('toggle');
				window.open('/search/person:political?search='+data, '_self')

			});


	}

	</script>

	

	<body style="">

			<nav class="navbar navbar-default navbar-fixed-top no-border nav-shadow">
			  	<div class="container-fluid">
			    	<div class="navbar-header" style="margin-top: 30px; margin-bottom: 30px">
				    	
					  		
					  	
				      	<div class="col-md-12">

							<form id="loginformA" action="/search/person:political" method="get">
							    <div class="input-group" >
							    	<input type="text" name="search" id="autocomplete" class="form-control" placeholder="Buscar..." value="<%= search %>" style="border-radius:0px"/>
							      
							    	

							      <span class="input-group-btn">
							        <button class="btn btn-site no-border" id="search_submit" type="submit"><i class="glyphicon glyphicon-search"></i> Buscar</button>
							      </span>
							    </div>
						    </form>
						</div>
			        
			    	</div>
			  	</div>
			</nav>
			


			<div class="panel panel-default no-border" style ="margin-top: 100px" align="center">
				<div class="panel-body">
			   	
	

					<div class="container">



							<div class="grid" id="grid_id">
							<% political_list.forEach(function(political) { %>

								
	         						<div class="grid-item">
	  
									
					
									    <div class="thumbnail political-thumbnail">

									    	<div class="rv">


									    	</div>

									    	
									    	
									    	<div class="rp">
									    		<a >
									    			
									    		</style>
									    		<img class="avatar" src="<%= political.foto %>" style="width: 120px; height: 120px; object-fit: cover;  margin-top: -70px; vertical-align: middle;">
									    		</a>

										        <h3><strong><%= political.nombre %></strong></h3>
										        
										       
										        <ul class="list-inline">
										        	<li>
										        
										        <li><a href="<%= political.Url%>" class="btn-thumbnail"><i class="fa fa-wikipedia-w"  style="margin-top:10px;" ></i></a></li>
										        <li><a class="btn-thumbnail"  href="/load/person:<%= political.nombre%>?id=<%= political.id%>" ><i class="fa fa-share-alt" style="margin-top:10px;" ></i></a></li>
										        </ul>
									      	</div>
									    </div>
							  		
							  		</div>

							  		
							  		
							  	
						  	<% }); %>
						  	
						  </div>

						
							  <div class="pagination" id="pagin">
							  	
							    
							      <a href="/search/person:<%=search %>?search=<%= search %>&page=<%= (parseInt(page)-1) %>" aria-label="Previous">
							        <span aria-hidden="true"><i class="fa fa-arrow-left" aria-hidden="true"></i></span>
							      </a>
							    
							    
							    <% for( i=1;i<=num_pages;i++){ %>

							    	<% if (page == i){ %>
								    	<a  class="active" type="button" id="page_<%= i %>" name="page_<%= i %>" href="/search/person:<%=search %>?search=<%= search %>&page=<%= i %>"><%= i %></a>
								    
								    
							    	<% } else{ %>
								    	<a  type="button" id="page_<%= i %>" name="page_<%= i %>" href="/search/person:<%=search %>?search=<%= search %>&page=<%= i %>"><%= i %></a>



									<% } %>
								<% } %>
								
							      <a href="/search/person:<%=search %>?search=<%= search %>&page=<%= (parseInt(page) + 1) %>" aria-label="Next">
							        <span aria-hidden="true"><i class="fa fa-arrow-right" aria-hidden="true"></i></span>
							      </a>
							    
							  
							
								</div>
							<div>

								<div class="panel panel-default" style ="margin-top: 10px; border-left-color: #1c84c6; border-left-width: 5px" align="left">

									<div class="panel-body">
										<h4><label id="label_search"><i id="load_label" class="fa fa-circle-o-notch fa-spin"></i> Tal vez estás buscando... </label><h4>
									</div>

								</div>

								<table class="table">
   
								    <tbody id="table_body">
								      
								      
								    </tbody>
								  </table>
							</div>
					</div>
				</div><!-- /.row -->
			</div>

			<div class="footer-bottom">

				<div class="container">

					<div class="row">

						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">

							<div class="copyright">

								© 2016-2017, "Nombre de la Aplicación"
							</div>

						</div>

						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">

							<div class="design">

								 <a target="_blank" href="http://comunidad.udistrital.edu.co/gesdatos/">Grupo de Investigación Gesdatos </a> |  <a target="_blank" href="https://www.udistrital.edu.co/">Universidad Distrital Francisco José de Caldas</a>

							</div>

						</div>

					</div>

				</div>

			</div>

	<div class="modal fade" id="loading_div" data-backdrop="static" data-keyboard="false">

		 <div class="modal-dialog">

		    <!-- Modal content-->
		    <div class="modal-content">
		    	
		      	<div class="modal-body" align="center">
		      		<h3><i class="fa fa-paper-plane" aria-hidden="true"></i> Estamos recolectando información...</h3>
		        	<img src="/images/loading.gif" />
		      	</div>
		      
		    </div>

		  </div>

	</div>
			
		
		

	</body>

</html>

